uncur
uncurl
uncurl "curl -X POST -H 'Content-Type: application/json' -d '{"expr":"1+1", "sig":"1234"}' 127.0.0.1:81/eval"
python
ls
cd ../../exploit/enum
ls
cd ../../
ls
cd ..
ls
cd crypt
ls
cd ../privesc
ls
echo r = requests.post("http://127.0.0.1:81/eval",data='{"expr":"1+1", "sig":"1234"}',headers={"Content-Type": "application/json"},cookies={}, )
echo 'r = requests.post("http://127.0.0.1:81/eval",data='{"expr":"1+1", "sig":"1234"}',headers={"Content-Type": "application/json"},cookies={}, )'
echo 'r = requests.post("http://127.0.0.1:81/eval",data='{"expr":"1+1", "sig":"1234"}',headers={"Content-Type": "application/json"},cookies={}, )' > working_req
cat working_req
cd ..
ls
cd ../../privesc
ls
vim enum_krypt.py
ls
vim kryptos.py
ls
cat working_req
echo 'r = requests.post("http://127.0.0.1:81/eval",data='{"expr":"1+1", "sig":"1234"}',headers={"Content-Type": "application/json"},cookies={}, )' > working_req
cat working_req
echo 'r = requests.post("http://127.0.0.1:81/eval",data='{\"expr\":\"1+1\", \"sig\":\"1234\"}',headers={"Content-Type": "application/json"},cookies={}, )' > working_req
cat working_req
vim enum_krypt.py
python3 enum_krypt.py
vim enum_krypt.py fc -lLn -64 > '/root/.tmux/resurrect/zsh_history-laptop:1.0'
vim enum_krypt.py
python3 enum_krypt.py
ls
vim enum_krypt.py
python3
python3 enum_krypt.py
ls
vim kryptos.py
python3 enum_krypt.py
ls
vim enum_krypt.py
ks
ls
cat working_req
cat enum_krypt.py | base64 -w 0
echo aW1wb3J0IHJhbmRvbSAKaW1wb3J0IGpzb24KaW1wb3J0IGhhc2hsaWIKaW1wb3J0IGJpbmFzY2lpCmltcG9ydCByZXF1ZXN0cwpmcm9tIGVjZHNhIGltcG9ydCBWZXJpZnlpbmdLZXksIFNpZ25pbmdLZXksIE5JU1QzODRwCgoKZGVmIHNlY3VyZV9ybmcoc2VlZCk6IAogICAgIyBUYWtlbiBmcm9tIHRoZSBpbnRlcm5ldCAtIHByb2JhYmx5IHNlY3VyZQogICAgcCA9IDIxNDc0ODM2NDcKICAgIGcgPSAyMjU1NDEyCgogICAga2V5TGVuZ3RoID0gMzIKICAgIHJldCA9IDAKICAgIHRocyA9IHJvdW5kKChwLTEpLzIpCiAgICBmb3IgaSBpbiByYW5nZShrZXlMZW5ndGgqOCk6CiAgICAgICAgc2VlZCA9IHBvdyhnLHNlZWQscCkKICAgICAgICBpZiBzZWVkID4gdGhzOgogICAgICAgICAgICByZXQgKz0gMioqaQogICAgcmV0dXJuIHJldAoKIyBTZXQgdXAgdGhlIGtleXMKcG9zc2libGVfa2V5cyA9IFtdCgpmb3IgaSBpbiByYW5nZSgyMDAwKToKICAgIHNlZWQgPSByYW5kb20uZ2V0cmFuZGJpdHMoMTI4KQogICAgcmFuZCA9IHNlY3VyZV9ybmcoc2VlZCkgKyAxCiAgICBpZiByYW5kIG5vdCBpbiBwb3NzaWJsZV9rZXlzOgogICAgICAgIHBvc3NpYmxlX2tleXMuYXBwZW5kKHJhbmQpCiAgICBlbHNlOgogICAgICAgIGNvbnRpbnVlCgpicmVha3BvaW50KCkKaGVhZGVycyA9IHsiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24ifQpieXRlX21zZyA9IGInMSsxJwp1cmwgPSAiaHR0cDovLzEyNy4wLjAuMTo4MS9ldmFsIgoKZm9yIGtleSBpbiBwb3NzaWJsZV9rZXlzOgogICAgc2sgPSBTaWduaW5nS2V5LmZyb21fc2VjcmV0X2V4cG9uZW50KGtleSwgY3VydmU9TklTVDM4NHApCiAgICBrZXkgPSBzay5zaWduKGJ5dGVfbXNnKQogICAgaGV4X2tleSA9IGJpbmFzY2lpLmhleGxpZnkoa2V5KQogICAgc3RyX2tleSA9IGhleF9rZXkuZGVjb2RlKCJVVEYtOCIpCiAgICBkYXRhID0geyJleHByIjoiMSsxIiwgInNpZyI6c3RyX2tleX0KICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybCwgZGF0YT1kYXRhLCBoZWFkZXJzPWhlYWRlcnMpCiAgICAKCiMgUHJpbnQgbnVtYmVyIG9mIHBvc3 | base64 -d
cat enum_krypt.py | base64 -w 0
ls
vim working_req
ls
echo aW1wb3J0IHJhbmRvbSAKaW1wb3J0IGpzb24KaW1wb3J0IGhhc2hsaWIKaW1wb3J0IGJpbmFzY2lpCmltcG9ydCByZXF1ZXN0cwpmcm9tIGVjZHNhIGltcG9ydCBWZXJpZnlpbmdLZXksIFNpZ25pbmdLZXksIE5JU1QzODRwCmltcG9ydCBwZGIKCgpkZWYgc2VjdXJlX3JuZyhzZWVkKTogCiAgICAjIFRha2VuIGZyb20gdGhlIGludGVybmV0IC0gcHJvYmFibHkgc2VjdXJlCiAgICBwID0gMjE0NzQ4MzY0NwogICAgZyA9IDIyNTU0MTIKCiAgICBrZXlMZW5ndGggPSAzMgogICAgcmV0ID0gMAogICAgdGhzID0gcm91bmQoKHAtMSkvMikKICAgIGZvciBpIGluIHJhbmdlKGtleUxlbmd0aCo4KToKICAgICAgICBzZWVkID0gcG93KGcsc2VlZCxwKQogICAgICAgIGlmIHNlZWQgPiB0aHM6CiAgICAgICAgICAgIHJldCArPSAyKippCiAgICByZXR1cm4gcmV0CgojIFNldCB1cCB0aGUga2V5cwpwb3NzaWJsZV9rZXlzID0gW10KCmZvciBpIGluIHJhbmdlKDIwMDApOgogICAgc2VlZCA9IHJhbmRvbS5nZXRyYW5kYml0cygxMjgpCiAgICByYW5kID0gc2VjdXJlX3JuZyhzZWVkKSArIDEKICAgIGlmIHJhbmQgbm90IGluIHBvc3NpYmxlX2tleXM6CiAgICAgICAgcG9zc2libGVfa2V5cy5hcHBlbmQocmFuZCkKICAgIGVsc2U6CiAgICAgICAgY29udGludWUKCmhlYWRlcnMgPSB7IkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIn0KYnl0ZV9tc2cgPSBiJzErMScKdXJsID0gImh0dHA6Ly8xMjcuMC4wLjE6ODEvZXZhbCIKCmZvciBrZXkgaW4gcG9zc2libGVfa2V5czoKICAgIHNrID0gU2lnbmluZ0tleS5mcm9tX3NlY3JldF9leHBvbmVudChrZXksIGN1cnZlPU5JU1QzODRwKQogICAga2V5ID0gc2suc2lnbihieXRlX21zZykKICAgIGhleF9rZXkgPSBiaW5hc2NpaS5oZXhsaWZ5KGtleSkKICAgIHN0cl9rZXkgPSBoZXhfa2V5LmRlY29kZSgiVVRGLTgiKQogICAgZGF0YSA9ICd7ImV4cHIiOiIxKzEiLCAic2lnIjoiJXMifScgJSBzdHJfa2V5CiAgICByZXEgPSByZXF1ZXN0cy5wb3N0KHVybCwgZGF0YT1kYXRhLCBoZWFkZXJzPWhlYWRlcnMpCiAgICBpZiByZXEudGV4dCA9PSAnQmFkIHNpZ25hdHVyZSc6CiAgICAgICAgcHJpbnQoIiVzIC0gV3Jvbmcga2V5OiAlcyIgJSAocmVxLnRleHQsIHN0cl9rZXkpKQogICAgICAgIGNvbnRpbnVlCiAgICBlbHNlOgogICAgICAgIHByaW50KCJUaGUga2V5IGlzOiAlcyIgJSBzdHJfa2V5KQogICAgICAgIGJyZWFrCiAgICAgCgojIFByaW50IG51bWJlciBvZiBwb3NzaWJsZSBrZXlzCiMgcHJpbnQoZW51bSkKIyBwcmludChsZW4oZW51bSkpCg== | base64 -d > bruteforce.py
vim bruteforce.py
ls
echo -n a0f4d5cb0af95bd4e66e14297646e44c01257776458ca91740dd69e5823d4181a21b13891b64f69286a5dcb2cbd58dfe1d9f1f1c0c35f5e725fad0b9f997f98abee5e5542c822aa396f682d04cae1d15512df765a53be561a11218aad9afcaed > key
ls
cat key
ls
s
ls
